(()=>{var e={909:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var s=i(81),n=i.n(s),a=i(645),o=i.n(a)()(n());o.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=VT323&display=swap);"]),o.push([e.id,"/***************************|\n | Defaults                 |\n ***************************/\nhtml, body {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  background: black;\n  font-family: 'VT323', monospace;\n}\n\ncanvas {\n  cursor: crosshair;\n}\n\n#current-level {\n  color: #50ffb0;\n}\n\n#equipped-weapon {\n  color: #27a2f5;\n}\n\n#enemies-remaining {\n  color: #ff4040;\n}\n\n.volume-slider {\n  background: linear-gradient(to right, #50ffb0 0%, #50ffb0 50%, #fff 50%, #fff 100%);\n  border: solid 1px #50ffb0;\n  border-radius: 8px;\n  height: 7px;\n  outline: none;\n  transition: background 450ms ease-in;\n  appearance: none;\n  -webkit-appearance: none;\n}\n\n/***************************|\n | Splash screen            |\n ***************************/\n.body-splash {\n  height: 100vh;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  flex-direction: column;\n  background-color: #fff;\n  background-image: url(\"./img/splash.webp\");\n  /* background-position: center; */\n  background-position-x: 0px;\n  background-position-y: 0px;\n  background-size: cover;\n  background-repeat: no-repeat;\n  position: relative;\n}\n\n.splash {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 100%;\n  height: 100%;\n  background: rgba(0,0,0,0.8);\n  display:flex;\n  align-items: center;\n}\n\n.splash__text {\n  width: 100%;\n  margin: auto;\n  position: absolute;\n  text-align: center;\n}\n\n.splash__heading {\n  margin: 0px auto;\n  font-size: 12rem;\n  text-transform: uppercase;\n  font-weight: bold;\n  text-shadow: 0 0 100px rgb(240 241 241 / 74%);\n  background: -webkit-linear-gradient(#09CF8D, #222222);\n  -webkit-background-clip: text;\n  background-clip: text;\n  -webkit-text-fill-color: transparent;\n  animation: splash 80s linear infinite;\n  transform: translate3d(0, 0, 0);\n  backface-visibility: hidden;\n  -webkit-animation: splash 80s linear infinite;\n  -webkit-transform: translate3d(0, 0, 0);\n  -webkit-backface-visibility: hidden;\n}\n\n@keyframes splash {\n  0% { background-position: 0% 50%; }\n  100% {background-position: 100% 50%; }\n}\n@-webkit-keyframes splash {\n  0% { background-position: 0% 50%; }\n  100% {background-position: 100% 50%; }\n}\n\n.splash__button {\n  display: block;\n  margin: 0 auto;\n  height: 70pt;\n  width: calc(30pt * 10);\n  cursor: pointer;\n  overflow: hidden;\n  white-space: nowrap;\n  user-select: none;\n  background: transparent;\n  image-rendering: pixelated;\n  border: 0;\n}\n\n.splash__button__text {\n  font-family: 'VT323', monospace;\n  font-size: 4rem;\n  width: 100%;\n  height: 100%;\n  padding-bottom: 0.3em;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  color: #eeeeee;\n  text-shadow: 0 0 15px #50ffb0;\n}\n\n.splash__button:hover .splash__button__text {\n  color: #f5d95c;\n  text-shadow: 0 0 30px #50ffb0;\n}\n\n\n/***************************|\n | Help and controls        |\n ***************************/\n.help-section {\n  position: absolute;\n  top: 30px;\n  left: 20px;\n  width: 300px;\n  font-family: Verdana, Geneva, Tahoma, sans-serif;\n  font-size: 1.2rem;\n  color: white;\n  background: rgba(34, 34, 34, 0.7);\n  box-shadow: 0 0 15px #50ffb0;\n  border: 1px solid #50ffb0;\n  border-radius: 5px;\n  padding: 15px;\n}\n\n.help-section__title {\n  margin-top: 0;\n  margin-bottom: 20px;\n}\n\n.help-section__separator {\n  margin-top: 20px;\n  margin-bottom: 20px;\n}\n\n.help-block {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n}\n\n.help-block--wrap {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 15px;\n  font-size:.75rem;\n}\n\n.help-block__img {\n  width: 40px;\n  /* margin-right: 20px; */\n}\n\n.help-block__text--muted {\n  font-size: 0.75rem;\n  color:#aaaaaa;\n}\n\n.help-block__hotkey {\n  padding: 5px 10px 5px 10px;\n  border: 1px solid white;\n  border-radius: 5px;\n  margin-right: 5px;\n  font-size: .75rem;\n}\n\n.help-block__hotkey--active {\n  background-color: #f5f5f5;\n  color: black;\n  box-shadow: 3px 3px #7e7e7d;\n}\n\n/***************************|\n | Game ended display       |\n ***************************/\n.game-ended {\n  display: none;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  text-align: center;\n}\n\n.game-ended__text {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 0;\n  height: 100%;\n  width: 100%;\n  color: white;\n}\n\n.game-ended__text--big {\n  font-size: 6rem;\n  text-transform: uppercase;\n}\n\n\n/***************************|\n | Out of ammo display      |\n ***************************/\n#out-of-ammo {\n  display: none;\n  border: none;\n  color: #be3e3e;\n  text-align: center;\n  text-shadow: 1px 5px 4px rgba(0, 0, 0, .3), 0 0 2px rgb(221, 145, 145), 0 0 10px;\n}\n\n#out-of-ammo span {\n  animation: blink .7s infinite alternate;\n}\n\n#out-of-ammo span.delay {\n  animation-duration: 6s;\n  animation-delay: 2s;\n  animation-direction: alternate cubic-bezier(0.5, 0.2, 0.3, 1.0)\n}\n\n@keyframes blink {\n  0% {}\n  50% {}\n  80% {\n    text-shadow: 0 0 2px rgba(255, 255, 255, .1), 0 0 10px rgba(255, 255, 255, .4);\n    text-stroke: 2px rgba(255, 255, 255, 0.05);\n  }\n}\n\n\n/***************************|\n | WSAD Map                 |\n ***************************/\n.keyboard {\n  width: 300px;\n  margin: 0 auto;\n}\n\n.keyboard__top-row {\n  width: 120px;\n  margin: 0 auto;\n}\n\n.keyboard__bottom-row {\n  display: inline-flex;\n}\n\n.keyboard__key {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #353943;\n  border: 1px solid #50ffb0;\n  box-shadow: 3px 3px #50ffb0;\n  border-radius: 5px;\n  color: #ffffff;\n  width: 60px;\n  margin: 15px;\n  text-align: center;\n  top: 0;\n  left: 0;\n  transition: all 0.07s ease;\n}\n\n.keyboard__key > p {\n  margin-top: 5px;\n  margin-bottom: 10px;\n}\n\n.keyboard__key--active {\n  background: #ffffff;\n  color: #000000;\n  box-shadow: 3px 3px #7e7e7d;\n}\n\n\n/***************************|\n | Stats UI                 |\n ***************************/\n.stats {\n  position: absolute;\n  top: 0px;\n  right: 0px;\n}\n\n\n/***************************|\n | Utility classes          |\n ***************************/\n.overlay {\n  display: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0,0,0,0.9);\n}\n\n.grow {\n  flex-grow: 1\n}\n\n.flex-align-gap {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.space-between {\n  justify-content: space-between;\n}\n\n.gap-10 {\n  gap: 10px;\n}\n\n.gap-20 {\n  gap: 20px;\n}\n\n.gap-40 {\n  gap: 40px;\n}\n\n.inactive {\n  display: none;\n}\n\n.fail {\n  background: rgba(197, 13, 13, 0.8);\n}\n\n.pass {\n  background: rgba(13, 197, 38, 0.712);\n}\n\n.mt-0 {\n  margin-top: 0;\n}\n\n.mb-0 {\n  margin-bottom: 0;\n}",""]);const r=o},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i="",s=void 0!==t[5];return t[4]&&(i+="@supports (".concat(t[4],") {")),t[2]&&(i+="@media ".concat(t[2]," {")),s&&(i+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),i+=e(t),s&&(i+="}"),t[2]&&(i+="}"),t[4]&&(i+="}"),i})).join("")},t.i=function(e,i,s,n,a){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(s)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(o[l]=!0)}for(var h=0;h<e.length;h++){var c=[].concat(e[h]);s&&o[c[0]]||(void 0!==a&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=a),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),n&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=n):c[4]="".concat(n)),t.push(c))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},466:function(e){var t;e.exports=((t=function(){function e(e){return n.appendChild(e.dom),e}function i(e){for(var t=0;t<n.children.length;t++)n.children[t].style.display=t===e?"block":"none";s=e}var s=0,n=document.createElement("div");n.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",n.addEventListener("click",(function(e){e.preventDefault(),i(++s%n.children.length)}),!1);var a=(performance||Date).now(),o=a,r=0,l=e(new t.Panel("FPS","#0ff","#002")),h=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:n,addPanel:e,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){r++;var e=(performance||Date).now();if(h.update(e-a,200),e>o+1e3&&(l.update(1e3*r/(e-o),100),o=e,r=0,c)){var t=performance.memory;c.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:n,setMode:i}}).Panel=function(e,t,i){var s=1/0,n=0,a=Math.round,o=a(window.devicePixelRatio||1),r=80*o,l=48*o,h=3*o,c=2*o,p=3*o,d=15*o,W=74*o,u=30*o,m=document.createElement("canvas");m.width=r,m.height=l,m.style.cssText="width:80px;height:48px";var f=m.getContext("2d");return f.font="bold "+9*o+"px Helvetica,Arial,sans-serif",f.textBaseline="top",f.fillStyle=i,f.fillRect(0,0,r,l),f.fillStyle=t,f.fillText(e,h,c),f.fillRect(p,d,W,u),f.fillStyle=i,f.globalAlpha=.9,f.fillRect(p,d,W,u),{dom:m,update:function(l,y){s=Math.min(s,l),n=Math.max(n,l),f.fillStyle=i,f.globalAlpha=1,f.fillRect(0,0,r,d),f.fillStyle=t,f.fillText(a(l)+" "+e+" ("+a(s)+"-"+a(n)+")",h,c),f.drawImage(m,p+o,d,W-o,u,p,d,W-o,u),f.fillRect(p+W-o,d,o,u),f.fillStyle=i,f.globalAlpha=.9,f.fillRect(p+W-o,d,o,a((1-l/y)*u))}}},t)},379:e=>{"use strict";var t=[];function i(e){for(var i=-1,s=0;s<t.length;s++)if(t[s].identifier===e){i=s;break}return i}function s(e,s){for(var a={},o=[],r=0;r<e.length;r++){var l=e[r],h=s.base?l[0]+s.base:l[0],c=a[h]||0,p="".concat(h," ").concat(c);a[h]=c+1;var d=i(p),W={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)t[d].references++,t[d].updater(W);else{var u=n(W,s);s.byIndex=r,t.splice(r,0,{identifier:p,updater:u,references:1})}o.push(p)}return o}function n(e,t){var i=t.domAPI(t);return i.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var a=s(e=e||[],n=n||{});return function(e){e=e||[];for(var o=0;o<a.length;o++){var r=i(a[o]);t[r].references--}for(var l=s(e,n),h=0;h<a.length;h++){var c=i(a[h]);0===t[c].references&&(t[c].updater(),t.splice(c,1))}a=l}}},569:e=>{"use strict";var t={};e.exports=function(e,i){var s=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,n&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var a=i.sourceMap;a&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleTagTransform(s,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function i(s){var n=t[s];if(void 0!==n)return n.exports;var a=t[s]={id:s,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var s in t)i.o(t,s)&&!i.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.nc=void 0,(()=>{"use strict";const e={cell:{radius:60,size:150},player:{health:100,speed:5},pickups:{size:75,ammo:!1,health:25,stamina:7.5},device:{keyboard:{up:!1,down:!1,left:!1,right:!1},mouse:{x:0,y:0,pressed:!1}},volumes:{fx:{weapon:.5,snippet:.5},soundtrack:.5}};class t{static intersection(e,t){return!(e.x+e.width<t.x||e.y+e.height<t.y||e.x>t.x+t.width||e.y>t.y+t.height)}static distance(e,t,i=!0){if(i)return Math.sqrt(e*e+t*t);const s=e.x-t.x,n=e.y-t.y;return Math.sqrt(s*s+n*n)}static arcWallVector({arcX:e,arcY:t,radius:i,wallX:s,wallY:n,size:a}){const o=Math.abs(e-s-a/2),r=Math.abs(t-n-a/2);if(o>a/2+i)return!1;if(r>a/2+i)return!1;if(o<=a/2)return!0;if(r<=a/2)return!0;const l=o-a/2,h=r-a/2;return l*l+h*h<=i*i}static entityToWalls(i,s){const n={x:0,y:0};for(let a=0;a<s.length;a++){const o=s[a];if(t.arcWallVector({arcX:i.x,arcY:i.y,radius:60,wallX:o.x,wallY:o.y,size:e.cell.size})){const s=o.x+e.cell.size/2,a=o.y+e.cell.size/2;let r=i.x-s,l=i.y-a;const h=t.distance(r,l);h>0&&(r/=h,l/=h,n.x+=r,n.y+=l)}}return n}static entityToPlayer(e,i,s){let n=i.player.x-e.x,a=i.player.y-e.y;i.player.dead?(n=e.lastVectorX,a=e.lastVectorY):(e.lastVectorX=n,e.lastVectorY=a);const o=t.distance(n,a);if("pickup"===e.type&&s&&o<=95&&s(),o>0&&"enemy"===e.type&&(n/=o,a/=o,o<800)){e.angle=Math.atan2(a,n)-90*Math.PI/180,e.x+=n*e.speed,e.y+=a*e.speed;const s=t.entityToWalls(e,i.walls);e.x+=s.x*e.speed,e.y+=s.y*e.speed,e.incrementer+=e.speed,e.position=Math.sin(e.incrementer*Math.PI/180),o<100&&"enemy"===e.type&&i.player.takeDamage(e)}}}class s{static render(t,i){if(!t.sleep)if("pickup"===t.type){i.shadowBlur=t.glow,i.shadowColor=t.color;const s=e.cell.size/2;t.image.complete?i.drawImage(t.image,t.x,t.y,s,s):t.image.onload=()=>i.drawImage(t.image,t.x,t.y,s,s)}else s.beginRotationOffset(i,t.x,t.y,t.angle),t.dead?"enemy"===t.type?s.deadEnemy(i):s.deadPlayer(i):"enemy"===t.type?s.enemy(i,t.position):s.player(i,t.position),s.endRotationOffset(i,t.x,t.y,t.angle),s.health(i,t.health,t.x,t.y)}static beginRotationOffset(e,t,i,s){e.translate(-(-t+e.canvas.width/2),-(-i+e.canvas.height/2)),e.translate(e.canvas.width/2,e.canvas.height/2),e.rotate(s)}static endRotationOffset(e,t,i,s){e.rotate(-s),e.translate(-e.canvas.width/2,-e.canvas.height/2),e.translate(+(-t+e.canvas.width/2),+(-i+e.canvas.height/2))}static player(e,t){e.shadowBlur=5,e.shadowColor="white",e.beginPath(),e.rect(20,35*t-20,25,40),e.fillStyle="#D95B43",e.fill(),e.beginPath(),e.rect(-40,-35*t-20,25,40),e.fillStyle="#D95B43",e.fill(),e.rotate(30*Math.PI/180),e.beginPath(),e.rect(40,-10,20,80),e.fillStyle="#C02942",e.fill(),e.rotate(-30*Math.PI/180),e.rotate(-50*Math.PI/180),e.beginPath(),e.rect(-55,-20,20,45),e.fillStyle="#C02942",e.fill(),e.rotate(50*Math.PI/180),e.beginPath(),e.rect(-60,-30,120,60),e.fillStyle="#53777A",e.fill(),e.beginPath(),e.rect(-12.5,30,25,70),e.fillStyle="gray",e.fill(),e.beginPath(),e.arc(0,0,40,0,2*Math.PI),e.fillStyle="#F1D4AF",e.fill(),e.rotate(-180*Math.PI/180),e.beginPath(),e.arc(0,0,50,0,180*Math.PI/180),e.fillStyle="#454B1B",e.fill(),e.rotate(180*Math.PI/180)}static deadPlayer(e){e.beginPath(),e.rect(30,20,25,40),e.fillStyle="#D95B43",e.fill(),e.beginPath(),e.rect(-25,-65,25,40),e.fillStyle="#D95B43",e.fill(),e.rotate(25*Math.PI/180),e.beginPath(),e.rect(40,-5,20,80),e.fillStyle="#C02942",e.fill(),e.rotate(-25*Math.PI/180),e.rotate(-60*Math.PI/180),e.beginPath(),e.rect(-40,20,20,45),e.fillStyle="#C02942",e.fill(),e.rotate(60*Math.PI/180),e.beginPath(),e.rect(-60,-30,120,60),e.fillStyle="#53777A",e.fill(),e.beginPath(),e.arc(20,10,35,0,2*Math.PI),e.fillStyle="#F1D4AF",e.fill(),e.rotate(-170*Math.PI/180),e.beginPath(),e.arc(0,0,32,0,180*Math.PI/180),e.fillStyle="#4d2600",e.fill(),e.rotate(170*Math.PI/180)}static enemy(e,t){e.shadowBlur=10,e.shadowColor="#8fce00",e.beginPath(),e.rect(20,35*t-20,25,40),e.fillStyle="#79BD9A",e.fill(),e.beginPath(),e.rect(-40,-35*t-20,25,40),e.fillStyle="#79BD9A",e.fill(),e.beginPath(),e.rect(-50,-10,20,90),e.fillStyle="#3B8686",e.fill(),e.beginPath(),e.rect(30,-10,20,85),e.fillStyle="#3B8686",e.fill(),e.beginPath(),e.rect(-60,-30,120,60),e.fillStyle="#0B486B",e.fill(),e.beginPath(),e.arc(0,0,40,0,2*Math.PI),e.fillStyle="#CFF09E",e.fill(),e.rotate(-180*Math.PI/180),e.beginPath(),e.arc(0,0,37,0,180*Math.PI/180),e.fillStyle="#880808",e.fill(),e.rotate(180*Math.PI/180)}static deadEnemy(e){e.beginPath(),e.rect(52,-30,25,40),e.fillStyle="#79BD9A",e.fill(),e.beginPath(),e.rect(26,-40,25,40),e.fillStyle="#79BD9A",e.fill(),e.beginPath(),e.rect(-25,35,20,90),e.fillStyle="#3B8686",e.fill(),e.beginPath(),e.rect(35,-40,20,85),e.fillStyle="#3B8686",e.fill(),e.beginPath(),e.rect(-42,-20,120,60),e.fillStyle="#0B486B",e.fill(),e.beginPath(),e.arc(10,5,35,0,2*Math.PI),e.fillStyle="#CFF09E",e.fill(),e.rotate(-170*Math.PI/180),e.beginPath(),e.arc(0,0,25,0,180*Math.PI/180),e.fillStyle="#4d2600",e.fill(),e.rotate(170*Math.PI/180)}static health(e,t,i,s){let n;e.beginPath(),e.rect(i-50,s+60,100,5),e.strokeStyle="black",e.stroke(),n=t<=35?"red":t<=75?"orange":"#50ffb0",e.beginPath(),e.rect(i-50,s+60,t,5),e.fillStyle=n,e.fill()}}const n=[{name:"Pistol",type:"gun",projectile:{color:"#F8CA00",delay:null,spread:{min:0,max:0},dps:30,dropoff:40},clip:{current:10,capacity:10},magazines:{current:2,capacity:2},trigger:!1,audio:{type:"single",fire:"./fx/audio/pistol/pistol-fire.mp3",reload:"./fx/audio/pistol/pistol-reload.mp3"}},{name:"Shotgun",type:"gun",projectile:{color:"#F8CA00",delay:null,spread:{min:-3,max:3},dps:50,dropoff:25},clip:{current:6,capacity:6},magazines:{current:2,capacity:2},trigger:!1,audio:{type:"single",fire:"./fx/audio/shotgun/shotgun-fire.mp3",reload:"./fx/audio/shotgun/shotgun-reload.mp3"}},{name:"Machine Gun",type:"gun",projectile:{color:["#CC5500","#F8CA00"],delay:null,spread:{min:0,max:0},dps:15,dropoff:40},clip:{current:225,capacity:225},magazines:{current:2,capacity:2},trigger:!0,audio:{type:"repeat",fire:"./fx/audio/machine-gun/machine-gun-fire.mp3",reload:"./fx/audio/machine-gun/machine-gun-reload.mp3"}},{name:"Flamethrower",type:"gun",projectile:{color:["#CC5500","#F8CA00"],delay:null,spread:{min:-5,max:5},dps:10,dropoff:20},clip:{current:600,capacity:600},magazines:{current:2,capacity:2},trigger:!0,audio:{type:"repeat",fire:"./fx/audio/flamethrower/flamethrower-fire.mp3",reload:"./fx/audio/flamethrower/flamethrower-reload.mp3"}},{name:"Grenade",type:"throwable",projectile:{color:["#CC5500","#F8CA00"],delay:2,spread:{min:-8,max:8},dps:75,dropoff:[20,40]},clip:{current:2,capacity:2},magazines:{current:1,capacity:1},trigger:!1,audio:{type:"single",fire:"./fx/audio/flamethrower/flamethrower-fire.mp3",reload:"./fx/audio/flamethrower/flamethrower-reload.mp3"}}],a=[{name:"lilbitch",types:["passed","kill"],enabled:!1,playback:"./fx/audio/snippets/lilbitch.mp3"},{name:"bloodyshoes",types:["passed","kill"],enabled:!1,playback:"./fx/audio/snippets/bloodyshoes.mp3"},{name:"nofucks",types:["passed","kill"],enabled:!1,playback:"./fx/audio/snippets/nofucks.mp3"},{name:"eoww",types:["hurt","kill"],enabled:!0,playback:"./fx/audio/snippets/eoww.mp3"},{name:"generic-pickup",types:["pickup"],enabled:!1,playback:"./fx/audio/snippets/pickup.mp3"},{name:"reload",types:["pickup"],enabled:!0,playback:"./fx/audio/snippets/reload.mp3"},{name:"inject",types:["pickup"],enabled:!0,playback:"./fx/audio/snippets/syringe2.mp3"}],o=["./soundtrack/track0.mp3","./soundtrack/track1.mp3","./soundtrack/track2.mp3","./soundtrack/track3.mp3","./soundtrack/track4.mp3","./soundtrack/track5.mp3"],r=new class{constructor(t=!0){this.audio={weapons:{},snippets:{}},this.soundtracks=[],this.loaded=!1,t&&this.load(["weapons","snippets","soundtrack"]),this.trackIndex=0,this.currentTrack=this.soundtracks[this.trackIndex],this.nextTrackReady=!1,this.trackListener=!1,this.fx={weapon:null,snippet:null},this.volumes=e.volumes}load(e=[]){if(e.includes("weapons"))for(const e of n)this.audio.weapons[e.name]={fire:new Audio(e.audio.fire),reload:new Audio(e.audio.reload)};if(e.includes("snippets"))for(const e of a)e.enabled&&(this.audio.snippets[e.name]={types:e.types,playback:new Audio(e.playback)});if(e.includes("soundtrack"))for(const e of o)this.soundtracks.push({name:e.split("/").pop(),playback:new Audio(e)});this.loaded=!0}stop(e){const t=this.fx[e];t&&!t.paused&&(t.pause(),t.currentTime=0)}async volume(e,t){"soundtrack"===e&&(this.volumes.soundtrack=t,this.currentTrack&&!this.currentTrack.playback.paused&&(this.currentTrack.playback.volume=this.volumes.soundtrack)),"weapon"===e&&(this.volumes.fx.weapon=t,this.fx.weapon&&!this.fx.weapon.paused&&(this.fx.weapon.volume=this.volumes.fx.weapon)),"snippet"===e&&(this.volumes.fx.snippet=t,this.fx.snippet&&!this.fx.snippet.paused&&(this.fx.snippet.volume=this.volumes.fx.snippet))}weapon({weaponIndex:e=null,equippedWeapon:t=null},i="fire",s=1){if(!this.loaded)return;const a=e?n[e]:t;a&&(this.fx.weapon="fire"===i?this.audio.weapons[a.name].fire:this.audio.weapons[a.name].reload,this.fx.weapon&&("repeat"!==a.audio.type&&this.stop("weapon"),this.fx.weapon.volume=this.volumes.fx.weapon,this.fx.weapon.playbackRate=s,this.fx.weapon.play()))}snippet({name:e=null,random:t=!1},i=1){if(!this.loaded)return;this.stop("snippet");const s=t?a[Math.floor(Math.random()*a.length)]:this.audio.snippets[e];s&&(this.fx.snippet=t?this.audio.snippets[s.name].playback:s.playback,this.fx.snippet.volume=this.volumes.fx.snippet,this.fx.weapon.playbackRate=i,this.fx.snippet.play())}soundtrack(){this.loaded&&(this.currentTrack&&this.currentTrack.playback&&(this.currentTrack.playback.paused||0===this.currentTrack.playback.currentTime)?(console.log(`now playing ${this.currentTrack.name}`),this.currentTrack.playback.volume=this.volumes.soundtrack,this.currentTrack.playback.play()):this.nextTrackReady&&(this.currentTrack.playback.pause(),this.currentTrack.playback.currentTime=0,++this.trackIndex,this.trackIndex>=this.soundtracks.length&&(this.trackIndex=0),console.log(`changed track index to ${this.trackIndex}`),this.trackListener=!1,this.currentTrack=this.soundtracks[this.trackIndex]),this.currentTrack&&!this.trackListener&&(this.nextTrackReady=!1,this.currentTrack.playback.addEventListener("ended",(()=>{this.nextTrackReady=!0,this.trackListener=!0}))))}};class l{constructor(t){this.type="player",this.bounding="arc",this.x=t.x*e.cell.size,this.y=t.y*e.cell.size,this.angle=0,this.position=0,this.incrementer=0,this.speed=5,this.stamina=!1,this.staminaAmount=0,this.sleep=!0,this.invincible=!1,this.health=100,this.damage={x:0,y:0},this.dead=!1}render(e){s.render(this,e)}update(e){if(this.sleep||this.dead)return;let i=0;i+=e.keyboard.up?1:0,i+=e.keyboard.down?1:0,i+=e.keyboard.left?1:0,i+=e.keyboard.right?1:0;let s=this.speed;i>1&&(s/=Math.sqrt(2)),Math.abs(this.damage.x)!=0<Math.abs(this.damage.y)!=0?(this.damage.x*=.9,this.damage.y*=.9,this.x+=this.damage.x,this.y+=this.damage.y,Math.abs(this.damage.x)<.5&&Math.abs(this.damage.y)<.5&&(this.damage={x:0,y:0},this.invincible=!1)):(e.keyboard.up&&(this.y-=s),e.keyboard.down&&(this.y+=s),e.keyboard.left&&(this.x-=s),e.keyboard.right&&(this.x+=s));const n=t.entityToWalls(this,e.walls);this.x+=n.x*s,this.y+=n.y*s;let a=e.camera.offsetX+e.context.canvas.width/2-e.mouse.x,o=e.camera.offsetY+e.context.canvas.height/2-e.mouse.y;const r=t.distance(a,o);r>0&&(a/=r,o/=r,this.angle=Math.atan2(o,a)+90*Math.PI/180),(e.keyboard.up||e.keyboard.down||e.keyboard.left||e.keyboard.right)&&(this.incrementer+=this.speed),this.position=Math.sin(this.incrementer*Math.PI/180)}takeDamage(e){if(!this.invincible){const i=this.x-e.x,s=this.y-e.y,n=t.distance(i,s);n>0&&(this.damage.x=i/n*20,this.damage.y=s/n*20,this.invincible=!0,this.health-=25,this.health=this.health<0?0:this.health,0==this.health&&(r.snippet({name:"eoww"}),this.dead=!0))}}boostSpeed(e){this.speed=e,setTimeout((()=>{this.speed=5}),3e3)}refillHealth(e){if(this.health<100){const t=this.health+e;t<=100&&(this.health=t)}}}class h{constructor(t){this.type="enemy",this.bounding="arc",this.x=t.x*e.cell.size,this.y=t.y*e.cell.size,this.angle=0,this.position=0,this.incrementer=0,this.speed=3,this.sleep=!0,this.pushAlongVelocity={x:0,y:0},this.pushProjectileVelocity={x:0,y:0},this.canBePushedByProjectile=!0,this.lastVectorX=0,this.lastVectorY=0,this.health=100,this.dead=!1,this.allEnemiesDead=!1}render(e){s.render(this,e)}update(i){if(this.sleep||this.dead)return;if(t.entityToPlayer(this,i),Math.random()<=.1)for(let e=0;e<i.enemies.length;e++){const s=i.enemies[e];if(s!=this){let e=s.x-this.x,i=s.y-this.y;const n=t.distance(e,i);0!=n&&n<100&&(e/=n,i/=n,s.pushAlong(e,i))}s.dead&&i.enemies.splice(e,1)}this.pushAlongVelocity.x*=.9,this.pushAlongVelocity.y*=.9,this.x+=this.pushAlongVelocity.x,this.y+=this.pushAlongVelocity.y;const s={x:this.x-e.cell.radius,y:this.y-e.cell.radius,width:2*e.cell.radius,height:2*e.cell.radius};for(let e=0;e<i.ballistics.projectiles.length;e++){const n=i.ballistics.projectiles[e];t.intersection(s,n.bounds)&&(n.markToDelete=!0,this.pushByProjectile(n,i.ballistics.weapon.projectile.dps,i.enemies))}this.pushProjectileVelocity.x*=.9,this.pushProjectileVelocity.y*=.9,this.x+=this.pushProjectileVelocity.x,this.y+=this.pushProjectileVelocity.y,Math.abs(this.pushProjectileVelocity.x)<.5&&Math.abs(this.pushProjectileVelocity.y)<.5&&(this.canBePushedByProjectile=!0,this.pushProjectileVelocity.x=0,this.pushProjectileVelocity.y=0)}pushAlong(e,t){this.pushAlongVelocity.x=10*e,this.pushAlongVelocity.y=10*t}pushByProjectile(e,t,i){this.canBePushedByProjectile&&(this.pushProjectileVelocity.x=15*e.vectorX,this.pushProjectileVelocity.y=15*e.vectorY,this.canBePushedByProjectile=!1,this.health-=t,this.health=this.health<0?0:this.health,0==this.health&&(this.dead=!0,document.querySelector("body").style.background="radial-gradient(white 5%, green 30%, black 100%)",setTimeout((()=>{document.querySelector("body").style.background="black"}),50),1===i.length&&(i.length=0,this.allEnemiesDead=!0)))}}class c{constructor(t,i,s=!1){this.type="wall",this.bounding="box",this.x=t*e.cell.size,this.y=i*e.cell.size,this.sleep=!0,this.textured=s,this.image=null,this.textured&&(this.textured=!0,this.image=new Image,this.image.src="img/wall.webp",this.image.width=e.cell.size,this.image.height=e.cell.size),this.bounds={x:this.x,y:this.y,width:e.cell.size,height:e.cell.size}}render(t){this.sleep||(t.shadowColor="#2b2b2b",t.shadowBlur=5,t.shadowOffsetX=10,t.shadowOffsetY=10,this.textured?this.image.complete?t.drawImage(this.image,this.x,this.y,e.cell.size,e.cell.size):this.image.onload=()=>t.drawImage(this.image,this.x,this.y,e.cell.size,e.cell.size):(t.beginPath(),t.rect(this.x,this.y,e.cell.size,e.cell.size),t.fillStyle="#444444",t.fill()))}}class p{constructor(t,i){this.type="pickup",this.item="ammo",this.value=e.pickups.ammo,this.bounding="arc",this.x=t*e.cell.size,this.y=i*e.cell.size,this.bounds={x:this.x,y:this.y,width:e.cell.size,height:e.cell.size},this.sleep=!0,this.image=new Image,this.image.src="img/magazine.png",this.glow=40,this.color="#F8CA00",this.markToDelete=!1}render(e){s.render(this,e)}update(e){t.entityToPlayer(this,e,(()=>{this.pickup()}))}pickup(){r.snippet({name:"reload"}),this.markToDelete=!0}}class d{constructor(t,i){this.type="pickup",this.item="health",this.value=e.pickups.health,this.bounding="arc",this.x=t*e.cell.size,this.y=i*e.cell.size,this.bounds={x:this.x,y:this.y,width:e.cell.size,height:e.cell.size},this.sleep=!0,this.image=new Image,this.image.src="img/first-aid-box.png",this.glow=40,this.color="#6C95C2",this.markToDelete=!1}render(e){s.render(this,e)}update(e){t.entityToPlayer(this,e,(()=>{this.pickup()}))}pickup(){r.snippet({name:"inject"}),this.markToDelete=!0}}class W{constructor(t,i){this.type="pickup",this.item="stamina",this.value=e.pickups.stamina,this.bounding="arc",this.x=t*e.cell.size,this.y=i*e.cell.size,this.bounds={x:this.x,y:this.y,width:e.cell.size,height:e.cell.size},this.sleep=!0,this.image=new Image,this.image.src="img/stamina.png",this.glow=40,this.color="#F5F5F5",this.markToDelete=!1}render(e){s.render(this,e)}update(e){t.entityToPlayer(this,e,(()=>{this.pickup()}))}pickup(){r.snippet({name:"inject"}),this.markToDelete=!0}}class u{constructor(t,i,s){this.vectorX=Math.cos(i.angle+90*Math.PI/180+5*s*Math.PI/180),this.vectorY=Math.sin(i.angle+90*Math.PI/180+5*s*Math.PI/180),this.x=i.x+this.vectorX*e.cell.radius*1.5,this.y=i.y+this.vectorY*e.cell.radius*1.5,this.radius=5,this.bounds={x:this.x-this.radius,y:this.y-this.radius,width:2*this.radius,height:2*this.radius},this.context=t,this.frames=0,this.markToDelete=!1}update(e,i=25){this.x+=this.vectorX*i,this.y+=this.vectorY*i,this.bounds.x=this.x-this.radius,this.bounds.y=this.y-this.radius,this.frames++,this.frames>15&&(this.markToDelete=!0);for(let i=0;i<e.length;i++){const s=e[i];t.intersection(s.bounds,this.bounds)&&(this.markToDelete=!0)}}render(e){Array.isArray(e)&&(e=e[Math.floor(Math.random()*e.length)]),this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI),this.context.fillStyle=e,this.context.fill()}}class m{constructor(t,i,s){this.vectorX=Math.cos(i.angle+90*Math.PI/180+5*s*Math.PI/180),this.vectorY=Math.sin(i.angle+90*Math.PI/180+5*s*Math.PI/180),this.x=i.x+this.vectorX*e.cell.radius*1.5,this.y=i.y+this.vectorY*e.cell.radius*1.5,this.radius=5,this.bounds={x:this.x-this.radius,y:this.y-this.radius,width:2*this.radius,height:2*this.radius},this.context=t,this.frames=0,this.markToDelete=!1}update(e,i=25){this.x+=this.vectorX*i,this.y+=this.vectorY*i,this.bounds.x=this.x-this.radius,this.bounds.y=this.y-this.radius,this.frames++,this.frames>15&&(this.markToDelete=!0);for(let i=0;i<e.length;i++){const s=e[i];t.intersection(s.bounds,this.bounds)&&(this.markToDelete=!0)}}render(e){Array.isArray(e)&&(e=e[Math.floor(Math.random()*e.length)]),this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI),this.context.fillStyle=e,this.context.fill()}}class f{constructor(){this.weapon=null,this.trigger=!0,this.frames=0,this.projectiles=[],this.indexesToDelete=[]}update(e){this.weapon=n[e.selectedWeaponIndex],this.setEquippedWeaponDisplayInformation(),this.weapon&&this.trigger&&!e.player.dead?(document.querySelector("#out-of-ammo").style.display="none",e.mouse.pressed?this.handleFire(e.context,e.player):r.stop("weapon")):(this.frames++,this.frames>=60&&(this.frames=0,this.trigger=!0)),this.cleanupProjectiles(e.walls)}render(){for(let e=0;e<this.projectiles.length;e++)this.projectiles[e].render(this.weapon.projectile.color)}handleFire(e,t){this.shouldReloadWeaponAmmoClip()||(--this.weapon.clip.current,r.weapon({equippedWeapon:this.weapon},"fire",1.5),this.registerProjectiles(e,t),this.trigger=this.weapon.trigger)}setEquippedWeaponDisplayInformation(){const{name:e,clip:t,magazines:i}=this.weapon;document.querySelector("#equipped-weapon").innerHTML=e,document.querySelector("#ammo-remaining").innerHTML=t.current,document.querySelector("#ammo-capacity").innerHTML=t.capacity,document.querySelector("#magazines-remaining").innerHTML=i.current,document.querySelector("#magazines-total").innerHTML=i.capacity}shouldReloadWeaponAmmoClip(){if(this.weapon.clip.current<=0){if(!(this.weapon.magazines.current>0))return this.weapon.clip.current=0,document.querySelector("#out-of-ammo").style.display="inline",!0;--this.weapon.magazines.current,this.refillWeaponAmmoClip()}return!1}refillWeaponAmmoClip(){this.weapon.clip.current===this.weapon.clip.capacity?this.weapon.magazines.current<this.weapon.magazines.capacity&&++this.weapon.magazines.current:this.weapon.clip.current=this.weapon.clip.capacity}registerProjectiles(e,t){const{spread:i,delay:s}=this.weapon.projectile;for(let n=i.min;n<=i.max;n++){const i="throwable"===this.weapon.type&&s?new m(e,t,n):new u(e,t,n);this.projectiles.push(i)}}cleanupProjectiles(e){this.indexesToDelete=[];for(let t=0;t<this.projectiles.length;t++)this.projectiles[t].update(e,this.weapon.projectile.dropoff),this.projectiles[t].markToDelete&&this.indexesToDelete.push(t);for(let e=0;e<this.indexesToDelete.length;e++)this.projectiles.splice(this.indexesToDelete[e],1)}}class y{constructor(e,t=0){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.context=e,this.frames=t}update(i,s){if(this.frames++,this.frames>=15){this.frames=0;const n={x:i.x-this.offsetX-this.context.canvas.width/2-this.size,y:i.y-this.offsetY-this.context.canvas.height/2-this.size,width:this.context.canvas.width+2*this.size,height:this.context.canvas.height+2*this.size};for(let i=0;i<s.length;i++){const a=s[i],o={};"arc"===a.bounding?(o.x=a.x-e.cell.radius,o.y=a.y-e.cell.radius,o.width=2*e.cell.radius,o.height=2*e.cell.radius):"box"===a.bounding&&(o.x=a.x,o.y=a.y,o.width=e.cell.size,o.height=e.cell.size),a.sleep=!t.intersection(o,n)}}}resize(){}newScene(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height)}preRender(e){const t=-e.x+this.context.canvas.width/2,i=-e.y+this.context.canvas.height/2,s=t-this.x,n=i-this.y;this.offsetX=this.x-t,this.offsetY=this.y-i,this.x+=s/10,this.y+=n/10,this.context.save(),this.context.translate(this.x,this.y)}postRender(){this.context.restore()}}const g=[["W W W W W W W W W W W W W W W W W W W W","W           W                         W","W           W   H   S                 W","W   P   W               H   A     E   W","W             A     W                 W","W W W W W     W W W W             E   W","W       W                 H           W","W   E   W   S     A   S       W   E   W","W       W                             W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W       W                             W","W   A   W   S     E             H     W","W   E   W                             W","W       W           E     W W W W W W W","W     W W                             W","W                   E                 W","W         E               S     E     W","W                                     W","W W W W W W W W W W W W W W           W","W                         W           W","W   H A E                 W           W","W                   E     W           W","W W W W W W W             W           W","W                         W     E     W","W               W W W W W W           W","W   P                     W           W","W                                     W","W         W W W                   E   W","W           W       E                 W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W          W                          W","W          W        E           E     W","W     P    W  E           S           W","W          W                  W W W W W","W               W         W           W","W               W   E                 W","W           E   W               E     W","W               W                     W","W W W W     W W W W W W W W     W     W","W                         W           W","W     E     E             W     E     W","W                   E     W           W","W W W W W W W             W           W","W       W         S       W           W","W   A   W   E         W W W W     W W W","W   E   W                 W           W","W                                 A   W","W     H   W W W             H     E   W","W           W       E                 W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W                 W                   W","W   A       E     W     E    E    A   W","W                 W                   W","W                                     W","W W W W W W           W   H     W     W","W         W     W                     W","W   E H   W     W     E               W","W               W            S        W","W W W W         W W W W W W           W","W            E  W         W     E     W","W   E                 E   W           W","W       E                 W           W","W   A        S  W         W     W     W","W               W     E   W           W","W W W W W W W W W         W W W       W","W                                     W","W   E     E         E         P       W","W   A   E       W         W           W","W               W     E   W           W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W                 W           W       W","W A   W   E   E   W     E     W   E   W","W     W           W           W       W","W   H     E       W     E     W   E   W","W                 W                   W","W   E       S                         W","W                   E   W     W       W","W         W W W W W           W       W","W   E             W     S     W   E   W","W            A    W           W       W","W   E             W     E     W     W W","W         W W W W W                   W","W   E                   W             W","W             W               W   H   W","W       W           W W W W W W       W","W W W W W   E E     W               E W","W                   W     A     W     W","W   P       W       W     A     W   E W","W                   W           W     W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W W W W W W","W                                               W","W     E       E             E     H             W","W                   W W W             E     E   W","W   E                             W       W     W","W     W W     E                                 W","W                   W W W             E     S   W","W     A   S   E     W             E             W","W                                   H     W     W","W       W     W W W               W       W     W","W   E   W         W   E   W   E   W   E   W     W","W       W     A   W       W       W             W","W W W W W     W W W W W W W W W W W       W W W W","W       W     W                   W             W","W   E   W     W   A         S     W       W     W","W       W             W W                 W     W","W             E       W W                       W","W     W     W     E             W     E     E   W","W           W                   W               W","W   E       W W W W W W W W W W W W W W     W W W","W                                 W             W","W   E       W W W W W       A     W   A         W","W                   W   E   A     W       P     W","W             H     W             W             W","W W W W W W W W W W W W W W W W W W W W W W W W W"]];class x{constructor(){this.levels=g,this.newMapConfiguration()}generate(e=1){const t=g[e];for(let e=0;e<t.length;e++){const i=t[e];for(let t=0;t<i.length;t+=2){const s=t/2;switch(i[t]){case"W":this.wallPositions.push({x:s,y:e});break;case"E":this.enemyPositions.push({x:s,y:e});break;case"A":this.ammoPickupPositions.push({x:s,y:e});break;case"H":this.healthPickupPositions.push({x:s,y:e});break;case"S":this.staminaPickupPositions.push({x:s,y:e});break;case"P":this.playerPosition={x:s,y:e}}}}}newMapConfiguration(){this.playerPosition={x:0,y:0},this.enemyPositions=[],this.wallPositions=[],this.ammoPickupPositions=[],this.healthPickupPositions=[],this.staminaPickupPositions=[]}getPlayerPosition(){return this.playerPosition}getEnemyPositions(){return this.enemyPositions}getWallPositions(){return this.wallPositions}getAmmoPickupPositions(){return this.ammoPickupPositions}getHealthPickupPositions(){return this.healthPickupPositions}getStaminaPickupPositions(){return this.staminaPickupPositions}}var b=i(466),k=i.n(b);class w{constructor(t,i){this.bridge=t,this.frame=null,this.stopped=!1,this.handlers={settings:null},this.context=i,this.camera=new y(this.context),this.keyboard=e.device.keyboard,this.mouse=e.device.mouse,this.map=new x,this.currentLevel=1,this.newGameEntities(),this.gameover=!1,this.levelPassed=!1;const s=()=>this.onResize(window.innerWidth,window.innerHeight);window.addEventListener("resize",s),s(),this.createKeyboardMouseControls(),this.createVolumeControls(),this.stats=new(k())}attach(e,t){this.handlers[e]=t}loop(){this.stats.begin(),r.soundtrack(),this.stopped||(this.frame=null,this.onUpdate(),this.onRender()),this.gameover&&(this.displayGameEnd(),this.restart()),this.stats.end(),this.run()}run(){this.frame||this.stopped||(this.frame=requestAnimationFrame(this.loop.bind(this)))}restart(){this.levelPassed?this.stop().then((async e=>await this.start(e,!0))):this.stop().then((async e=>await this.start(e,!1)))}async start(e,t=!1){if(e&&!this.frame){const e=document.querySelector(".game-ended");t&&++this.currentLevel,setTimeout((()=>{e.style.display="none",this.setup({level:this.currentLevel},!0)}),2e3)}}async pause(){const e=document.querySelector('span[data-hotkey="P"]'),t=document.querySelector("#game-pause-state"),i="help-block__hotkey--active";return this.stopped?(e.classList.remove(i),t.innerHTML="Pause Game",this.stopped=!1,this.frame=requestAnimationFrame(this.loop.bind(this))):(this.stopped=!0,cancelAnimationFrame(this.frame),e.classList.add(i),t.innerHTML="Game Paused"),this.stopped}async stop(){return this.stopped=!0,this.frame=null,cancelAnimationFrame(this.loop.bind(this)),this.stopped}setup({level:e=1},t=!1){this.frame=null,this.stopped=!1,this.gameover=!1,this.currentLevel=e,this.levelPassed=!1,this.newGameEntities(),this.generateMap(e).createPlayer().createEnemies().createWalls().createAmmoPickups().createHealthPickups().createStaminaPickups(),document.querySelector("#current-level").innerHTML=this.currentLevel,this.setWeaponHotKey(),this.onResize(window.innerWidth,window.innerHeight),t&&this.loop()}newGameEntities(){this.player=null,this.entities=[],this.walls=[],this.enemies=[],this.ammoPickups=[],this.healthPickups=[],this.staminaPickups=[],this.selectedWeaponIndex=0,this.ballistics=new f}onUpdate(){this.camera.update(this.player,this.entities),this.ballistics.update(this);for(let e=0;e<this.entities.length;e++)this.canUpdateEntity(this.entities[e])&&this.entities[e].update(this),"player"===this.entities[e].type&&this.isPlayerDead(this.entities[e])&&(this.gameover=!0),"enemy"===this.entities[e].type&&this.areAllEnemiesDead(this.entities[e])&&(this.gameover=!0,this.levelPassed=!0),"pickup"===this.entities[e].type&&this.entities[e].markToDelete&&("ammo"===this.entities[e].item&&this.ballistics.refillWeaponAmmoClip(),"health"===this.entities[e].item&&this.player.refillHealth(this.entities[e].value),"stamina"===this.entities[e].item&&this.player.boostSpeed(this.entities[e].value),this.entities.splice(e,1));document.querySelector("#enemies-remaining").innerHTML=this.enemies.length}onRender(){this.camera.newScene(),this.camera.preRender(this.player),this.ballistics.render();for(let e=0;e<this.entities.length;e++)this.entities[e].render(this.context);this.camera.postRender()}onResize(e,t){this.context.canvas.width=e,this.context.canvas.height=t,this.camera.resize()}generateMap(e=0){return this.map.newMapConfiguration(),this.map.generate(e),this}canUpdateEntity(e){return void 0!==e&&"function"==typeof e.update}createPlayer(){return this.player=new l(this.map.getPlayerPosition()),this.entities.push(this.player),this}createEnemies(){for(let e=0;e<this.map.getEnemyPositions().length;e++){const t=new h(this.map.getEnemyPositions()[e]);this.entities.push(t),this.enemies.push(t)}return this}createWalls(){for(let e=0;e<this.map.getWallPositions().length;e++){const t=this.map.getWallPositions()[e],i=new c(t.x,t.y,!0);this.entities.push(i),this.walls.push(i)}return this}createAmmoPickups(){for(let e=0;e<this.map.getAmmoPickupPositions().length;e++){const t=this.map.getAmmoPickupPositions()[e],i=new p(t.x,t.y);this.entities.push(i),this.ammoPickups.push(i)}return this}createHealthPickups(){for(let e=0;e<this.map.getHealthPickupPositions().length;e++){const t=this.map.getHealthPickupPositions()[e],i=new d(t.x,t.y);this.entities.push(i),this.healthPickups.push(i)}return this}createStaminaPickups(){for(let e=0;e<this.map.getStaminaPickupPositions().length;e++){const t=this.map.getStaminaPickupPositions()[e],i=new W(t.x,t.y);this.entities.push(i),this.staminaPickups.push(i)}return this}isPlayerDead(e){return"player"===e.type&&e.dead}areAllEnemiesDead(e){return"enemy"===e.type&&e.allEnemiesDead}displayGameEnd(){const e=document.querySelector(".game-ended");setTimeout((()=>{this.levelPassed?(e.querySelector("h1").innerHTML="You Win!",e.classList.add("pass"),e.classList.remove("fail")):(e.querySelector("h1").innerHTML="You Died!",e.classList.remove("pass"),e.classList.add("fail")),e.style.display="flex"}),500)}setWeaponHotKey(){const e=document.querySelectorAll("span.help-block__hotkey"),t="help-block__hotkey--active";for(const i of e){const{hotkey:e}=i.dataset;e&&(parseInt(e)!==this.selectedWeaponIndex+1?i.classList.remove(t):i.classList.add(t))}}createKeyboardMouseControls(){window.addEventListener("keydown",(async e=>{"p"===e.key&&await this.pause()})),document.addEventListener("keydown",(e=>{switch(e.key){case"w":this.keyboard.up=!0;break;case"s":this.keyboard.down=!0;break;case"a":this.keyboard.left=!0;break;case"d":this.keyboard.right=!0;break;case"1":this.selectedWeaponIndex=0,this.setWeaponHotKey();break;case"2":this.selectedWeaponIndex=1,this.setWeaponHotKey();break;case"3":this.selectedWeaponIndex=2,this.setWeaponHotKey();break;case"4":this.selectedWeaponIndex=3,this.setWeaponHotKey();break;case"5":this.selectedWeaponIndex=4,this.setWeaponHotKey();break;case"*":this.toggleStats()}})),document.addEventListener("keyup",(e=>{switch(e.key){case"w":this.keyboard.up=!1;break;case"s":this.keyboard.down=!1;break;case"a":this.keyboard.left=!1;break;case"d":this.keyboard.right=!1}})),document.addEventListener("mousemove",(e=>{this.mouse.x=e.clientX,this.mouse.y=e.clientY})),document.addEventListener("mousedown",(()=>{this.mouse.pressed=!0})),document.addEventListener("mouseup",(()=>{this.mouse.pressed=!1}))}createVolumeControls(){const e=document.querySelectorAll(".volume-slider");for(const t of e)t.addEventListener("input",(e=>{const{target:t}=e,i=(t.value-t.min)/(t.max-t.min),s=Math.round(100*i);t.style.background="linear-gradient(to right, #50ffb0 0%, #50ffb0 "+s+"%, #fff "+s+"%, #fff 100%)",console.log(t.dataset),r.volume(t.dataset.control,i),this.handlers.settings&&setTimeout((()=>{this.handlers.settings.setSetting("volumes",r.volumes,!0)}),1e3)}))}toggleStats(e=0){this.stats.showPanel(e),this.statsShown?(this.stats.domElement.style.cssText="display:none;",this.statsShown=!1):(this.stats.domElement.style.cssText="position:absolute;top:0px;right:0px;",this.statsShown=!0);const t=document.querySelector(".stats");t&&t.appendChild(this.stats.dom)}}var v=i(379),P=i.n(v),S=i(795),E=i.n(S),M=i(569),T=i.n(M),A=i(565),I=i.n(A),z=i(216),L=i.n(z),j=i(589),_=i.n(j),D=i(909),C={};C.styleTagTransform=_(),C.setAttributes=I(),C.insert=T().bind(null,"head"),C.domAPI=E(),C.insertStyleElement=L(),P()(D.Z,C),D.Z&&D.Z.locals&&D.Z.locals;const H=document.querySelector("#undead-bytes"),q=document.querySelector(".splash"),B=document.querySelector("canvas#game"),F=Object.prototype.hasOwnProperty.call(window,"executionBridge")&&null!==window.executionBridge?window.executionBridge:"web",V=new class{constructor(t,{register:i=!1}){this.localStorageSettingsKey="undeadbytes-game",this.settings={godmode:!1,difficulty:"medium",volumes:e.volumes},this.bridge=t,"web"===this.bridge?this.configureLocalStorage():this.configureFileStorage(),i&&this.register()}register(){this.setVolumeSettings()}setBridge(e){this.bridge=e}setSettings(e,t=!1){this.settings=e,t&&("web"===this.bridge?this.saveLocalStorageSettings():this.saveFileSettings())}setSetting(e,t,i=!1){this.settings[e]=t,i&&("web"===this.bridge?this.saveLocalStorageSettings():this.saveFileSettings())}configureFileStorage(){this.bridge.receive("from:settings:set",(e=>{e&&(this.setSettings(e),this.register())}))}configureLocalStorage(){const e=JSON.parse(localStorage.getItem(this.localStorageSettingsKey));e?this.setSettings(e):this.saveLocalStorageSettings()}saveLocalStorageSettings(){localStorage.setItem(this.localStorageSettingsKey,JSON.stringify(this.settings))}saveFileSettings(){this.bridge.send("to:settings:save",{settings:this.settings})}setVolumeSettings(e=null){e||(e=this.settings.volumes),e.fx&&e.fx.weapon&&r.volume("weapon",e.fx.weapon),e.fx&&e.fx.snippet&&r.volume("snippet",e.fx.snippet),e.soundtrack&&r.volume("soundtrack",e.soundtrack),this.settings.volumes=e,"web"===this.bridge&&this.saveLocalStorageSettings(),this.setUIState("volume")}setDifficultySettings(e){this.difficulty=e}setGodModeSettings(e){this.godmode=e}setUIState(e){if("volume"===e){const e=document.querySelectorAll(".volume-slider");for(const t of e){const{control:e}=t.dataset,i=["weapon","snippet"].includes(e)?this.settings.volumes.fx[e]:this.settings.volumes[e];t.value=i;const s=Math.round(100*i);t.style.background="linear-gradient(to right, #50ffb0 0%, #50ffb0 "+s+"%, #fff "+s+"%, #fff 100%)"}}}}(F,{register:!0});document.querySelector("#play-now").addEventListener("click",(()=>{q&&(document.body.classList.remove("body-splash"),q.style.display="none",H.classList.remove("inactive")),function(){if(!H.classList.contains("inactive")&&B){const e=new w(F,B.getContext("2d"));e.attach("settings",V),e.setup({level:1},!0),window.addEventListener("keydown",(function(e){const t=document.querySelector(`[data-key="${e.key}"]`);"w"!==e.key&&"a"!==e.key&&"s"!==e.key&&"d"!==e.key||t&&t.classList.add("keyboard__key--active")})),window.addEventListener("keyup",(e=>{const t=document.querySelector(`[data-key="${e.key}"]`);t&&t.classList.remove("keyboard__key--active")})),function(e,t=2e3){console.log("%c Logging game data to console","background: #222; color: yellow"),console.log(`%c Refreshes every ${(t%6e4/1e3).toFixed(2)} seconds`,"background: #222; color: yellow"),setInterval((()=>{const t=`W: ${e.walls.length} | E: ${e.enemies.length} | A: ${e.ammoPickups.length} | H: ${e.healthPickups.length}`;var i;console.log(`%c Player Health: ${e.player.health}`,"background: #222; color: #bfff00"),console.log(`%c Enemies Alive: ${e.enemies.length}`,"background: #222; color: #FF033E"),console.log(`%c Gameover State: ${e.gameover}`,"background: #222; color: #00ffff"),console.log("%c Entity Data:","background: #222; color: #ffffff"),console.log(`%c Total: ${e.entities.length} | Curr: ${i=e,i.walls.length+i.enemies.length+i.ammoPickups.length+i.healthPickups.length+1}`,"background: #222; color: #ffffff"),console.log(`%c ${t}\n\n`,"background: #222; color: #ffffff")}),t)}(e,1e4)}}()}))})()})();