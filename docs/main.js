(()=>{"use strict";var t={556:(t,e,i)=>{i.d(e,{Z:()=>h});var s=i(81),a=i.n(s),n=i(645),o=i.n(n)()(a());o.push([t.id,"html, body {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  margin: 0;\n  padding: 0;\n}\n\nbody {\n  background: black;\n}\n\n.help {\n  position: absolute;\n  top: 30px;\n  left: 20px;\n  font-family: Verdana, Geneva, Tahoma, sans-serif;\n  font-size: 1.2rem;\n  color: white;\n  background: rgba(34, 34, 34, 0.75);\n  border: 1px solid rgb(34, 34, 34);\n  border-radius: 5px;\n  padding: 15px;\n}\n\n.help p {\n  margin-top: 0;\n  margin-bottom: 10px;\n}\n\n.help hr {\n  margin-top: 20px;\n  margin-bottom: 20px;\n}\n\n#current-level {\n  color: #74f074;\n}\n\n#equipped-weapon {\n  color: #27a2f5;\n}\n\n#enemies-remaining {\n  color: #ff4040;\n}\n\n#out-of-ammo {\n  display: none;\n  color: #be3e3e;\n}\n\n.game-ended-wrapper {\n  display: none;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  text-align: center;\n}\n\n.game-ended {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  width: 100%;\n}\n\n.game-ended h1 {\n  margin-bottom: 0;\n  font-family: Verdana, Geneva, Tahoma, sans-serif;\n  font-size: 6rem;\n  color: white;\n  text-transform: uppercase;\n}\n\n.level-failed {\n  background: rgba(197, 13, 13, 0.8);\n}\n\n.level-passed {\n  background: rgba(13, 197, 38, 0.712);\n}\n\n.out-of-ammo {\n  border: none;\n  color: rgba(255, 255, 255, 0.5);\n  text-align: center;\n  text-shadow: 1px 5px 4px rgba(0, 0, 0, .3), 0 0 2px rgb(221, 145, 145), 0 0 10px;\n}\n\n.out-of-ammo span {\n  animation: blink .7s infinite alternate;\n}\n\n.out-of-ammo span.delay {\n  animation-duration: 6s;\n  animation-delay: 2s;\n  animation-direction: alternate cubic-bezier(0.5, 0.2, 0.3, 1.0)\n}\n\n@keyframes blink {\n  0% {}\n  50% {}\n  80% {\n    text-shadow: 0 0 2px rgba(255, 255, 255, .1), 0 0 10px rgba(255, 255, 255, .4);\n    text-stroke: 2px rgba(255, 255, 255, 0.05);\n  }\n}\n\n.keyboard {\n  width: 300px;\n  margin: 0 auto;\n}\n.keyboard .top-row {\n  width: 120px;\n  margin: 0 auto;\n}\n.keyboard .bottom-row {\n  display: inline-flex;\n}\n.keyboard-key {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: #353943;\n  border: 1px solid #8fce00;\n  box-shadow: 3px 3px #d9ff82;\n  border-radius: 5px;\n  color: #ffffff;\n  width: 60px;\n  margin: 15px;\n  text-align: center;\n  top: 0;\n  left: 0;\n  transition: all 0.07s ease;\n}\n.keyboard-key__active {\n  background: #ffffff;\n  color: #000000;\n  box-shadow: 3px 3px #7e7e7d;\n}\n.keyboard-key > p {\n  margin-top: 5px;\n  margin-bottom: 10px;\n}",""]);const h=o},645:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i="",s=void 0!==e[5];return e[4]&&(i+="@supports (".concat(e[4],") {")),e[2]&&(i+="@media ".concat(e[2]," {")),s&&(i+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),i+=t(e),s&&(i+="}"),e[2]&&(i+="}"),e[4]&&(i+="}"),i})).join("")},e.i=function(t,i,s,a,n){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(s)for(var h=0;h<this.length;h++){var l=this[h][0];null!=l&&(o[l]=!0)}for(var r=0;r<t.length;r++){var c=[].concat(t[r]);s&&o[c[0]]||(void 0!==n&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=n),i&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=i):c[2]=i),a&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=a):c[4]="".concat(a)),e.push(c))}},e}},81:t=>{t.exports=function(t){return t[1]}},379:t=>{var e=[];function i(t){for(var i=-1,s=0;s<e.length;s++)if(e[s].identifier===t){i=s;break}return i}function s(t,s){for(var n={},o=[],h=0;h<t.length;h++){var l=t[h],r=s.base?l[0]+s.base:l[0],c=n[r]||0,W="".concat(r," ").concat(c);n[r]=c+1;var d=i(W),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var u=a(p,s);s.byIndex=h,e.splice(h,0,{identifier:W,updater:u,references:1})}o.push(W)}return o}function a(t,e){var i=e.domAPI(e);return i.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;i.update(t=e)}else i.remove()}}t.exports=function(t,a){var n=s(t=t||[],a=a||{});return function(t){t=t||[];for(var o=0;o<n.length;o++){var h=i(n[o]);e[h].references--}for(var l=s(t,a),r=0;r<n.length;r++){var c=i(n[r]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}n=l}}},569:t=>{var e={};t.exports=function(t,i){var s=function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}(t);if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(i)}},216:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,i)=>{t.exports=function(t){var e=i.nc;e&&t.setAttribute("nonce",e)}},795:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(i){!function(t,e,i){var s="";i.supports&&(s+="@supports (".concat(i.supports,") {")),i.media&&(s+="@media ".concat(i.media," {"));var a=void 0!==i.layer;a&&(s+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),s+=i.css,a&&(s+="}"),i.media&&(s+="}"),i.supports&&(s+="}");var n=i.sourceMap;n&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(n))))," */")),e.styleTagTransform(s,t,e.options)}(e,t,i)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}}},e={};function i(s){var a=e[s];if(void 0!==a)return a.exports;var n=e[s]={id:s,exports:{}};return t[s](n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.nc=void 0,(()=>{const t=[{name:"Pistol",spread:{min:0,max:0},dps:30,dropoff:40,clip:10,capacity:10,magazines:2,magazinesTotal:2,bulletColor:"#F8CA00",automatic:!1,audioType:"single",audioFire:"./fx/audio/pistol/pistol-fire.mp3",audioReload:"./fx/audio/pistol/pistol-reload.mp3"},{name:"Shotgun",spread:{min:-3,max:3},dps:50,dropoff:25,clip:6,capacity:6,magazines:2,magazinesTotal:2,bulletColor:"#F8CA00",automatic:!1,audioType:"single",audioFire:"./fx/audio/shotgun/shotgun-fire.mp3",audioReload:"./fx/audio/shotgun/shotgun-reload.mp3"},{name:"Machine Gun",spread:{min:0,max:0},dps:15,dropoff:40,clip:225,capacity:225,magazines:1,magazinesTotal:1,bulletColor:["#CC5500","#F8CA00"],automatic:!0,audioType:"repeat",audioFire:"./fx/audio/machine-gun/machine-gun-fire.mp3",audioReload:"./fx/audio/machine-gun/machine-gun-reload.mp3"},{name:"Flamethrower",spread:{min:-5,max:5},dps:10,dropoff:20,clip:600,capacity:600,magazines:2,magazinesTotal:2,bulletColor:["#CC5500","#F8CA00"],automatic:!0,audioType:"repeat",audioFire:"./fx/audio/flamethrower/flamethrower-fire.mp3",audioReload:"./fx/audio/flamethrower/flamethrower-reload.mp3"}],e=new class{constructor(){this.audio={};for(const e of t)this.audio[e.name]={fire:new Audio(e.audioFire),reload:new Audio(e.audioReload)};this.playback=null}play({weaponIndex:e=null,equippedWeapon:i=null},s="fire",a=1){const n=e?t[e]:i;n&&(this.playback="fire"===s?this.audio[n.name].fire:this.audio[n.name].reload,this.playback&&(this.playback.volume=.3,"repeat"!==n.audioType&&this.stop(),this.playback.playbackRate=a,this.playback.play()))}stop(){this.playback&&!this.playback.paused&&(this.playback.pause(),this.playback.currentTime=0)}},s=60,a=150,n={up:!1,down:!1,left:!1,right:!1},o={x:0,y:0,pressed:!1};class h{static arcWallVector({arcX:t,arcY:e,radius:i,wallX:s,wallY:a,size:n}){const o=Math.abs(t-s-n/2),h=Math.abs(e-a-n/2);if(o>n/2+i)return!1;if(h>n/2+i)return!1;if(o<=n/2)return!0;if(h<=n/2)return!0;const l=o-n/2,r=h-n/2;return l*l+r*r<=i*i}static vector(t,e,i){const s={x:0,y:0};for(let n=0;n<i.length;n++){const o=i[n];if(h.arcWallVector({arcX:t,arcY:e,radius:60,wallX:o.x,wallY:o.y,size:a})){let i=t-(o.x+75),a=e-(o.y+75);const n=Math.sqrt(i*i+a*a);n>0&&(i/=n,a/=n,s.x+=i,s.y+=a)}}return s}}class l{static player(t,e){t.shadowBlur=5,t.shadowColor="white",t.beginPath(),t.rect(20,35*e-20,25,40),t.fillStyle="#D95B43",t.fill(),t.beginPath(),t.rect(-40,-35*e-20,25,40),t.fillStyle="#D95B43",t.fill(),t.rotate(30*Math.PI/180),t.beginPath(),t.rect(40,-10,20,80),t.fillStyle="#C02942",t.fill(),t.rotate(-30*Math.PI/180),t.rotate(-50*Math.PI/180),t.beginPath(),t.rect(-55,-20,20,45),t.fillStyle="#C02942",t.fill(),t.rotate(50*Math.PI/180),t.beginPath(),t.rect(-60,-30,120,60),t.fillStyle="#53777A",t.fill(),t.beginPath(),t.rect(-12.5,30,25,70),t.fillStyle="gray",t.fill(),t.beginPath(),t.arc(0,0,40,0,2*Math.PI),t.fillStyle="#F1D4AF",t.fill(),t.rotate(-180*Math.PI/180),t.beginPath(),t.arc(0,0,50,0,180*Math.PI/180),t.fillStyle="#454B1B",t.fill(),t.rotate(180*Math.PI/180)}static deadPlayer(t){t.beginPath(),t.rect(30,20,25,40),t.fillStyle="#D95B43",t.fill(),t.beginPath(),t.rect(-25,-65,25,40),t.fillStyle="#D95B43",t.fill(),t.rotate(25*Math.PI/180),t.beginPath(),t.rect(40,-5,20,80),t.fillStyle="#C02942",t.fill(),t.rotate(-25*Math.PI/180),t.rotate(-60*Math.PI/180),t.beginPath(),t.rect(-40,20,20,45),t.fillStyle="#C02942",t.fill(),t.rotate(60*Math.PI/180),t.beginPath(),t.rect(-60,-30,120,60),t.fillStyle="#53777A",t.fill(),t.beginPath(),t.arc(20,10,35,0,2*Math.PI),t.fillStyle="#F1D4AF",t.fill(),t.rotate(-170*Math.PI/180),t.beginPath(),t.arc(0,0,32,0,180*Math.PI/180),t.fillStyle="#4d2600",t.fill(),t.rotate(170*Math.PI/180)}static enemy(t,e){t.shadowBlur=10,t.shadowColor="#8fce00",t.beginPath(),t.rect(20,35*e-20,25,40),t.fillStyle="#79BD9A",t.fill(),t.beginPath(),t.rect(-40,-35*e-20,25,40),t.fillStyle="#79BD9A",t.fill(),t.beginPath(),t.rect(-50,-10,20,90),t.fillStyle="#3B8686",t.fill(),t.beginPath(),t.rect(30,-10,20,85),t.fillStyle="#3B8686",t.fill(),t.beginPath(),t.rect(-60,-30,120,60),t.fillStyle="#0B486B",t.fill(),t.beginPath(),t.arc(0,0,40,0,2*Math.PI),t.fillStyle="#CFF09E",t.fill(),t.rotate(-180*Math.PI/180),t.beginPath(),t.arc(0,0,37,0,180*Math.PI/180),t.fillStyle="#880808",t.fill(),t.rotate(180*Math.PI/180)}static deadEnemy(t){t.beginPath(),t.rect(52,-30,25,40),t.fillStyle="#79BD9A",t.fill(),t.beginPath(),t.rect(26,-40,25,40),t.fillStyle="#79BD9A",t.fill(),t.beginPath(),t.rect(-25,35,20,90),t.fillStyle="#3B8686",t.fill(),t.beginPath(),t.rect(35,-40,20,85),t.fillStyle="#3B8686",t.fill(),t.beginPath(),t.rect(-42,-20,120,60),t.fillStyle="#0B486B",t.fill(),t.beginPath(),t.arc(10,5,35,0,2*Math.PI),t.fillStyle="#CFF09E",t.fill(),t.rotate(-170*Math.PI/180),t.beginPath(),t.arc(0,0,25,0,180*Math.PI/180),t.fillStyle="#4d2600",t.fill(),t.rotate(170*Math.PI/180)}static health(t,e,i,s){let a;t.beginPath(),t.rect(i-50,s+60,100,5),t.strokeStyle="black",t.stroke(),a=e<=35?"red":e<=75?"orange":"lime",t.beginPath(),t.rect(i-50,s+60,e,5),t.fillStyle=a,t.fill()}}class r{static intersection(t,e){return!(t.x+t.width<e.x||t.y+t.height<e.y||t.x>e.x+e.width||t.y>e.y+e.height)}static beginRotationOffset(t,e,i,s){t.translate(-(-e+t.canvas.width/2),-(-i+t.canvas.height/2)),t.translate(t.canvas.width/2,t.canvas.height/2),t.rotate(s)}static endRotationOffset(t,e,i,s){t.rotate(-s),t.translate(-t.canvas.width/2,-t.canvas.height/2),t.translate(+(-e+t.canvas.width/2),+(-i+t.canvas.height/2))}static render(t,e){r.beginRotationOffset(t,e.x,e.y,e.angle),e.dead?"enemy"===e.type?l.deadEnemy(t):l.deadPlayer(t):"enemy"===e.type?l.enemy(t,e.position):l.player(t,e.position),r.endRotationOffset(t,e.x,e.y,e.angle),l.health(t,e.health,e.x,e.y)}static playerToEntity(t,e,i){let s=e.player.x-t.x,a=e.player.y-t.y;e.player.dead?(s=t.lastVectorX,a=t.lastVectorY):(t.lastVectorX=s,t.lastVectorY=a);let n=Math.sqrt(s*s+a*a);if("pickup"===t.type&&i&&n<=95&&i(),n>0&&"pickup"!==t.type&&(s/=n,a/=n,n<800)){t.angle=Math.atan2(a,s)-90*Math.PI/180,t.x+=s*t.speed,t.y+=a*t.speed;const i=h.vector(t.x,t.y,e.walls);t.x+=i.x*t.speed,t.y+=i.y*t.speed,t.incrementer+=t.speed,t.position=Math.sin(t.incrementer*Math.PI/180),n<100&&"enemy"===t.type&&e.player.takeDamage(t)}}}class c{constructor(t,e,i){this.vectorX=Math.cos(e.angle+90*Math.PI/180+5*i*Math.PI/180),this.vectorY=Math.sin(e.angle+90*Math.PI/180+5*i*Math.PI/180),this.x=e.x+this.vectorX*s*1.5,this.y=e.y+this.vectorY*s*1.5,this.radius=5,this.bounds={x:this.x-this.radius,y:this.y-this.radius,width:2*this.radius,height:2*this.radius},this.context=t,this.frames=0,this.markToDelete=!1}update(t,e=25){this.x+=this.vectorX*e,this.y+=this.vectorY*e,this.bounds.x=this.x-this.radius,this.bounds.y=this.y-this.radius,this.frames++,this.frames>15&&(this.markToDelete=!0);for(let e=0;e<t.length;e++){const i=t[e];r.intersection(i.bounds,this.bounds)&&(this.markToDelete=!0)}}render(t){Array.isArray(t)&&(t=t[Math.floor(Math.random()*t.length)]),this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI),this.context.fillStyle=t,this.context.fill()}}class W{constructor(){this.weapon=null,this.automatic=!0,this.frames=0,this.bullets=[],this.indexesToDelete=[]}update(i){this.weapon=t[i.selectedWeaponIndex],this.setEquippedWeaponDisplayInformation(),this.weapon&&this.automatic&&!i.player.dead?(document.querySelector("#out-of-ammo").style.display="none",i.mouse.pressed?this.handleFire(i.context,i.player):e.stop()):(this.frames++,this.frames>=60&&(this.frames=0,this.automatic=!0)),this.cleanupBullets(i.walls)}render(){for(let t=0;t<this.bullets.length;t++)this.bullets[t].render(this.weapon.bulletColor)}handleFire(t,i){--this.weapon.clip,this.shouldReloadWeaponAmmoClip()||(e.play({equippedWeapon:this.weapon},"fire",1.5),this.registerBullets(t,i),this.automatic=this.weapon.automatic)}setEquippedWeaponDisplayInformation(){const{name:t,clip:e,capacity:i,magazines:s,magazinesTotal:a}=this.weapon;document.querySelector("#equipped-weapon").innerHTML=t,document.querySelector("#ammo-remaining").innerHTML=e,document.querySelector("#ammo-capacity").innerHTML=i,document.querySelector("#magazines-remaining").innerHTML=s,document.querySelector("#magazines-total").innerHTML=a}shouldReloadWeaponAmmoClip(){if(this.weapon.clip<=0){if(!(this.weapon.magazines>0))return this.weapon.clip=0,document.querySelector("#out-of-ammo").style.display="inline",!0;--this.weapon.magazines,this.refillWeaponAmmoClip()}return!1}refillWeaponAmmoClip(){this.weapon.clip=this.weapon.capacity}registerBullets(t,e){const{spread:i}=this.weapon;for(let s=i.min;s<=i.max;s++){const i=new c(t,e,s);this.bullets.push(i)}}cleanupBullets(t){this.indexesToDelete=[];for(let e=0;e<this.bullets.length;e++)this.bullets[e].update(t,this.weapon.dropoff),this.bullets[e].markToDelete&&this.indexesToDelete.push(e);for(let t=0;t<this.indexesToDelete.length;t++)this.bullets.splice(this.indexesToDelete[t],1)}}class d{constructor(t){this.type="player",this.bounding="arc",this.x=t.x*a,this.y=t.y*a,this.angle=0,this.position=0,this.incrementer=0,this.speed=5,this.sleep=!0,this.invincible=!1,this.health=100,this.damage={x:0,y:0},this.dead=!1}takeDamage(t){if(!this.invincible){const e=this.x-t.x,i=this.y-t.y,s=Math.sqrt(e*e+i*i);s>0&&(this.damage.x=e/s*20,this.damage.y=i/s*20,this.invincible=!0,this.health-=25,this.health=this.health<0?0:this.health,0==this.health&&(this.dead=!0))}}refillHealth(t){if(this.health<100){const e=this.health+t;e<=100&&(this.health=e)}}update(t){if(this.sleep||this.dead)return;let e=0;e+=t.keyboard.up?1:0,e+=t.keyboard.down?1:0,e+=t.keyboard.left?1:0,e+=t.keyboard.right?1:0;let i=this.speed;e>1&&(i/=Math.sqrt(2)),Math.abs(this.damage.x)!=0<Math.abs(this.damage.y)!=0?(this.damage.x*=.9,this.damage.y*=.9,this.x+=this.damage.x,this.y+=this.damage.y,Math.abs(this.damage.x)<.5&&Math.abs(this.damage.y)<.5&&(this.damage={x:0,y:0},this.invincible=!1)):(t.keyboard.up&&(this.y-=i),t.keyboard.down&&(this.y+=i),t.keyboard.left&&(this.x-=i),t.keyboard.right&&(this.x+=i));const s=h.vector(this.x,this.y,t.walls);this.x+=s.x*i,this.y+=s.y*i;let a=t.camera.offsetX+t.context.canvas.width/2-t.mouse.x,n=t.camera.offsetY+t.context.canvas.height/2-t.mouse.y;const o=Math.sqrt(a*a+n*n);o>0&&(a/=o,n/=o,this.angle=Math.atan2(n,a)+90*Math.PI/180),(t.keyboard.up||t.keyboard.down||t.keyboard.left||t.keyboard.right)&&(this.incrementer+=this.speed),this.position=Math.sin(this.incrementer*Math.PI/180)}render(t){this.sleep||r.render(t,this)}}class p{constructor(t){this.type="enemy",this.bounding="arc",this.x=t.x*a,this.y=t.y*a,this.angle=0,this.position=0,this.incrementer=0,this.speed=3,this.sleep=!0,this.pushAlongVelocity={x:0,y:0},this.pushBulletVelocity={x:0,y:0},this.canBePushedByBullet=!0,this.lastVectorX=0,this.lastVectorY=0,this.health=100,this.dead=!1,this.allEnemiesDead=!1}pushAlong(t,e){this.pushAlongVelocity.x=10*t,this.pushAlongVelocity.y=10*e}pushByBullet(t,e,i){this.canBePushedByBullet&&(this.pushBulletVelocity.x=15*t.vectorX,this.pushBulletVelocity.y=15*t.vectorY,this.canBePushedByBullet=!1,this.health-=e,this.health=this.health<0?0:this.health,0==this.health&&(this.dead=!0,document.querySelector("body").style.background="radial-gradient(white 5%, green 30%, black 100%)",setTimeout((()=>{document.querySelector("body").style.background="black"}),50),1===i.length&&(i.length=0,this.allEnemiesDead=!0)))}update(t){if(this.sleep||this.dead)return;if(r.playerToEntity(this,t),Math.random()<=.1)for(let e=0;e<t.enemies.length;e++){const i=t.enemies[e];if(i!=this){let t=i.x-this.x,e=i.y-this.y;const s=Math.sqrt(t*t+e*e);0!=s&&s<100&&(t/=s,e/=s,i.pushAlong(t,e))}i.dead&&t.enemies.splice(e,1)}this.pushAlongVelocity.x*=.9,this.pushAlongVelocity.y*=.9,this.x+=this.pushAlongVelocity.x,this.y+=this.pushAlongVelocity.y;const e={x:this.x-s,y:this.y-s,width:120,height:120};for(let i=0;i<t.ballistics.bullets.length;i++){const s=t.ballistics.bullets[i];r.intersection(e,s.bounds)&&(s.markToDelete=!0,this.pushByBullet(s,t.ballistics.weapon.dps,t.enemies))}this.pushBulletVelocity.x*=.9,this.pushBulletVelocity.y*=.9,this.x+=this.pushBulletVelocity.x,this.y+=this.pushBulletVelocity.y,Math.abs(this.pushBulletVelocity.x)<.5&&Math.abs(this.pushBulletVelocity.y)<.5&&(this.canBePushedByBullet=!0,this.pushBulletVelocity.x=0,this.pushBulletVelocity.y=0)}render(t){this.sleep||r.render(t,this)}}class u{constructor(t,e,i=!1){this.bounding="box",this.x=t*a,this.y=e*a,this.sleep=!0,this.textured=i,this.image=null,this.textured&&(this.textured=!0,this.image=new Image,this.image.src="img/wall.png",this.image.width=a,this.image.height=a),this.bounds={x:this.x,y:this.y,width:a,height:a}}render(t){this.sleep||(t.shadowColor="#2b2b2b",t.shadowBlur=5,t.shadowOffsetX=10,t.shadowOffsetY=10,this.textured?this.image.complete?t.drawImage(this.image,this.x,this.y,a,a):this.image.onload=()=>t.drawImage(this.image,this.x,this.y,a,a):(t.beginPath(),t.rect(this.x,this.y,a,a),t.fillStyle="#444444",t.fill()))}}class m{constructor(t,e){this.type="pickup",this.item="ammo",this.bounding="arc",this.x=t*a,this.y=e*a,this.sleep=!0,this.image=new Image,this.image.src="img/magazine.png",this.image.width=50,this.glow=40,this.bounds={x:this.x,y:this.y,width:a,height:a},this.markToDelete=!1}update(t){r.playerToEntity(this,t,(()=>{this.pickup()}))}render(t){this.sleep||(t.shadowBlur=this.glow,t.shadowColor="yellow",this.image.complete?t.drawImage(this.image,this.x,this.y,75,75):this.image.onload=()=>t.drawImage(this.image,this.x,this.y,75,75))}pickup(){this.markToDelete=!0}}class y{constructor(t,e){this.type="pickup",this.item="health",this.value=25,this.bounding="arc",this.x=t*a,this.y=e*a,this.sleep=!0,this.image=new Image,this.image.src="img/first-aid-box.png",this.image.width=50,this.glow=40,this.bounds={x:this.x,y:this.y,width:a,height:a},this.markToDelete=!1}update(t){r.playerToEntity(this,t,(()=>{this.pickup()}))}render(t){this.sleep||(t.shadowBlur=this.glow,t.shadowColor="#6c95c2",this.image.complete?t.drawImage(this.image,this.x,this.y,75,75):this.image.onload=()=>t.drawImage(this.image,this.x,this.y,75,75))}pickup(){this.markToDelete=!0}}const f=[["W W W W W W W W W W W W W W W ","W                           W","W                           W","W   P   W     A             W","W                           W","W         H         A       W","W                           W","W         E       A         W","W                           W","W W W W W W W W W W W W W W W "],["W W W W W W W W W W W W W W W W W W W W","W       W                             W","W   A   W                       H     W","W   E   W                             W","W       W           E     W W W W W W W","W     W W                             W","W                   E                 W","W         E                     E     W","W                                     W","W W W W W W W W W W W W W W           W","W                         W           W","W   H A E                 W           W","W                   E     W           W","W W W W W W W             W           W","W                         W     E     W","W               W W W W W W           W","W   P                     W           W","W                                     W","W         W W W                   E   W","W           W       E                 W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W          W                          W","W          W        E           E     W","W     P    W  E                       W","W          W                  W W W W W","W               W         W           W","W               W   E                 W","W           E   W               E     W","W               W                     W","W W W W     W W W W W W W W     W     W","W                         W           W","W     E     E             W     E     W","W                   E     W           W","W W W W W W W             W           W","W       W                 W           W","W   A   W   E         W W W W     W W W","W   E   W                 W           W","W                                 A   W","W     H   W W W                   E   W","W           W       E                 W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W                 W                   W","W   A E     E     W     E    E    A   W","W                 W       E           W","W                                     W","W W W W W W           W   H     W     W","W         W     W                     W","W   E     W     W     E               W","W               W                     W","W W W W         W W W W W W           W","W   E        E  W         W     E     W","W                     E   W           W","W       E                 W           W","W               W         W     W     W","W               W     E   W           W","W W W W W W W W W         W W W       W","W   E     E                           W","W                   E         P       W","W   A   E       W         W           W","W               W     E   W           W","W W W W W W W W W W W W W W W W W W W W"],["W W W W W W W W W W W W W W W W W W W W","W                 W           W       W","W A   W   E   E   W     E     W   E   W","W     W           W           W       W","W   H     E       W     E     W   E   W","W                 W                   W","W   E                                 W","W                   E   W     W       W","W         W W W W W           W       W","W   E             W           W   E   W","W            A    W           W       W","W   E             W     E     W     W W","W         W W W W W                   W","W   E                   W             W","W             W               W   H   W","W       W           W W W W W W       W","W W W W W   E E     W               E W","W                   W     A     W     W","W P         W       W     A     W   E W","W                   W           W     W","W W W W W W W W W W W W W W W W W W W W"]];class g{constructor(){this.levels=f,this.newMapConfiguration()}generate(t=1){const e=f[t];for(let t=0;t<e.length;t++){const i=e[t];for(let e=0;e<i.length;e+=2){const s=e/2;switch(i[e]){case"W":this.wallPositions.push({x:s,y:t});break;case"E":this.enemyPositions.push({x:s,y:t});break;case"A":this.ammoPickupPositions.push({x:s,y:t});break;case"H":this.healthPickupPositions.push({x:s,y:t});break;case"P":this.playerPosition={x:s,y:t}}}}}newMapConfiguration(){this.playerPosition={x:0,y:0},this.enemyPositions=[],this.wallPositions=[],this.ammoPickupPositions=[],this.healthPickupPositions=[]}getPlayerPosition(){return this.playerPosition}getEnemyPositions(){return this.enemyPositions}getWallPositions(){return this.wallPositions}getAmmoPickupPositions(){return this.ammoPickupPositions}getHealthPickupPositions(){return this.healthPickupPositions}}class x{constructor(t,e=0){this.x=0,this.y=0,this.offsetX=0,this.offsetY=0,this.context=t,this.frames=e}update(t,e){if(this.frames++,this.frames>=15){this.frames=0;const i={x:t.x-this.offsetX-this.context.canvas.width/2-this.size,y:t.y-this.offsetY-this.context.canvas.height/2-this.size,width:this.context.canvas.width+2*this.size,height:this.context.canvas.height+2*this.size};for(let t=0;t<e.length;t++){const n=e[t],o={};"arc"===n.bounding?(o.x=n.x-s,o.y=n.y-s,o.width=120,o.height=120):"box"===n.bounding&&(o.x=n.x,o.y=n.y,o.width=a,o.height=a),n.sleep=!r.intersection(o,i)}}}resize(){}preRender(t){const e=-t.x+this.context.canvas.width/2,i=-t.y+this.context.canvas.height/2,s=e-this.x,a=i-this.y;this.offsetX=this.x-e,this.offsetY=this.y-i,this.x+=s/10,this.y+=a/10,this.context.save(),this.context.translate(this.x,this.y)}postRender(){this.context.restore()}}var b=i(379),w=i.n(b),P=i(795),v=i.n(P),k=i(569),E=i.n(k),M=i(565),A=i.n(M),S=i(216),I=i.n(S),B=i(589),T=i.n(B),C=i(556),D={};D.styleTagTransform=T(),D.setAttributes=A(),D.insert=E().bind(null,"head"),D.domAPI=v(),D.insertStyleElement=I(),w()(C.Z,D),C.Z&&C.Z.locals&&C.Z.locals;const q=new class{constructor(t){this.frame=null,this.stopped=!1,this.context=t,this.camera=new x(this.context),this.keyboard=n,this.mouse=o,this.map=new g,this.currentLevel=1,this.newGameEntities(),this.gameover=!1,this.levelPassed=!1}loop(){this.stopped||(this.frame=null,this.onUpdate(),this.onRender()),this.gameover&&(this.displayGameEnd(),this.restart()),this.run()}run(){this.frame||this.stopped||(this.frame=requestAnimationFrame(this.loop.bind(this)))}restart(){this.levelPassed?this.stop().then((async t=>await this.start(t,!0))):this.stop().then((async t=>await this.start(t,!1)))}async start(t,e=!1){if(t&&!this.frame){const t=document.querySelector(".game-ended-wrapper");e&&++this.currentLevel,setTimeout((()=>{t.style.display="none",this.setup({level:this.currentLevel},!0)}),2e3)}}async stop(){return this.stopped=!0,this.frame=null,cancelAnimationFrame(this.loop.bind(this)),this.stopped}setup({level:t=1},e=!1){this.frame=null,this.stopped=!1,this.gameover=!1,this.levelPassed=!1,this.newGameEntities(),this.generateMap(t).createPlayer().createEnemies().createWalls().createAmmoPickups().createHealthPickups(),document.querySelector("#current-level").innerHTML=this.currentLevel,e&&this.loop()}newGameEntities(){this.player=null,this.entities=[],this.walls=[],this.enemies=[],this.ammoPickups=[],this.healthPickups=[],this.selectedWeaponIndex=0,this.ballistics=new W}onUpdate(){this.camera.update(this.player,this.entities),this.ballistics.update(this);for(let t=0;t<this.entities.length;t++)this.canUpdateEntity(this.entities[t])&&this.entities[t].update(this),"player"===this.entities[t].type&&this.isPlayerDead(this.entities[t])&&(this.gameover=!0),"enemy"===this.entities[t].type&&this.areAllEnemiesDead(this.entities[t])&&(this.gameover=!0,this.levelPassed=!0),"pickup"===this.entities[t].type&&this.entities[t].markToDelete&&("ammo"===this.entities[t].item&&this.ballistics.refillWeaponAmmoClip(),"health"===this.entities[t].item&&this.player.refillHealth(this.entities[t].value),this.entities.splice(t,1));document.querySelector("#enemies-remaining").innerHTML=this.enemies.length}onRender(){this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),this.camera.preRender(this.player),this.ballistics.render();for(let t=0;t<this.entities.length;t++)this.entities[t].render(this.context);this.camera.postRender()}onResize(t,e){this.context.canvas.width=t,this.context.canvas.height=e,this.camera.resize()}generateMap(t=0){return this.map.newMapConfiguration(),this.map.generate(t),this}canUpdateEntity(t){return void 0!==t&&"function"==typeof t.update}createPlayer(){return this.player=new d(this.map.getPlayerPosition()),this.entities.push(this.player),this}createEnemies(){for(let t=0;t<this.map.getEnemyPositions().length;t++){const e=new p(this.map.getEnemyPositions()[t]);this.entities.push(e),this.enemies.push(e)}return this}createWalls(){for(let t=0;t<this.map.getWallPositions().length;t++){const e=this.map.getWallPositions()[t],i=new u(e.x,e.y,!0);this.entities.push(i),this.walls.push(i)}return this}createAmmoPickups(){for(let t=0;t<this.map.getAmmoPickupPositions().length;t++){const e=this.map.getAmmoPickupPositions()[t],i=new m(e.x,e.y);this.entities.push(i),this.ammoPickups.push(i)}return this}createHealthPickups(){for(let t=0;t<this.map.getHealthPickupPositions().length;t++){const e=this.map.getHealthPickupPositions()[t],i=new y(e.x,e.y);this.entities.push(i),this.healthPickups.push(i)}return this}isPlayerDead(t){return"player"===t.type&&t.dead}areAllEnemiesDead(t){return"enemy"===t.type&&t.allEnemiesDead}displayGameEnd(){const t=document.querySelector(".game-ended-wrapper");setTimeout((()=>{this.levelPassed?(t.querySelector("h1").innerHTML="You Win!",t.classList.add("level-passed"),t.classList.remove("level-failed")):(t.querySelector("h1").innerHTML="You Died!",t.classList.remove("level-passed"),t.classList.add("level-failed")),t.style.display="flex"}),500)}createKeyboardMouseControls(){document.addEventListener("keydown",(t=>{switch(t.key){case"w":this.keyboard.up=!0;break;case"s":this.keyboard.down=!0;break;case"a":this.keyboard.left=!0;break;case"d":this.keyboard.right=!0;break;case"1":this.selectedWeaponIndex=0;break;case"2":this.selectedWeaponIndex=1;break;case"3":this.selectedWeaponIndex=2;break;case"4":this.selectedWeaponIndex=3}})),document.addEventListener("keyup",(t=>{switch(t.key){case"w":this.keyboard.up=!1;break;case"s":this.keyboard.down=!1;break;case"a":this.keyboard.left=!1;break;case"d":this.keyboard.right=!1}})),document.addEventListener("mousemove",(t=>{this.mouse.x=t.clientX,this.mouse.y=t.clientY})),document.addEventListener("mousedown",(()=>{this.mouse.pressed=!0})),document.addEventListener("mouseup",(()=>{this.mouse.pressed=!1}))}}(document.querySelector("canvas#main").getContext("2d"));q.setup({level:1});const L=()=>q.onResize(window.innerWidth,window.innerHeight);window.addEventListener("resize",L),L(),q.createKeyboardMouseControls(),q.loop(),window.addEventListener("keydown",(function(t){const e=document.querySelector(`[data-key="${t.key}"]`);"w"!==t.key&&"a"!==t.key&&"s"!==t.key&&"d"!==t.key||e&&e.classList.add("keyboard-key__active")})),window.addEventListener("keyup",(t=>{const e=document.querySelector(`[data-key="${t.key}"]`);e&&e.classList.remove("keyboard-key__active")}))})()})();